<!--

Web frontend for Housing Transparency editing page. This file allows user to edit/delete existing listings and add new listings to Firebase.

Start ../server.js and then visit this URL to view this webpage:

http://localhost:3000/firebase.html

-->

<html>
<head>
 <title>Housing Transparency - Edit Listing</title>
 <link href="/style.css" rel="stylesheet">

 <script src="https://www.gstatic.com/firebasejs/5.0.2/firebase.js"></script>
 <script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBsnkZUolaSp6Y68kpU579Ok9nsTgbqVyU",
    authDomain: "cogs121-w-c-s.firebaseapp.com",
    databaseURL: "https://cogs121-w-c-s.firebaseio.com",
    projectId: "cogs121-w-c-s",
    storageBucket: "",
    messagingSenderId: "502637431727"
  };
  firebase.initializeApp(config);
</script>

<script src="jquery-3.3.1.min.js"></script>

<script type="text/javascript">
  $(document).ready(() => {
   const database = firebase.database();

      // Resets Firebase to default mode
      $('#resetButton').click(()=> {
        console.log('resetting the database');
        database.ref('La Jolla/').remove();
        database.ref('Little Italy/').remove();
        database.ref('Clairemont/').remove();
        database.ref('La Jolla/Villas of Renaissance').set({lowestPrice:"1855", highestPrice: "3800", rating: "3.5", risk:"0.51-1.60 (High)", image:"VoR.jpg", location:"La Jolla", estate2: "Villas of Renaissance", lat: "32.869468", lng: "-117.203863", liq: "No"});
        database.ref('La Jolla/La Regencia').set({lowestPrice:"2000", highestPrice: "3600", rating: "2.5", risk:"0.51-1.60 (High)", image:"LR.jpg", location:"La Jolla", estate2: "La Regencia", lat: "32.863263", lng: "-117.223298", liq: "No"});
        database.ref('La Jolla/La Scala').set({lowestPrice:"1670", highestPrice: "1975", rating: "3", risk:"0.51-1.60 (High)", image:"LS.jpg", location:"La Jolla", estate2: "La Scala", lat: "32.867878", lng: "-117.223761", liq: "No"});
        database.ref('Little Italy/Camden Tuscany').set({lowestPrice:"2859", highestPrice: "3269", rating: "3.5", risk:"0.51-1.60 (High)",image:"Camden.jpg", location:"Little Italy", estate2:"Camden Tuscany", lat: "32.722293", lng: "-117.169368", liq: "Yes"});
        database.ref('Little Italy/Il Palazzo').set({lowestPrice:"1672", highestPrice: "3243", rating: "4", risk:"0.51-1.60 (High)",image:"IP.jpg",location:"Little Italy", estate2:"Il Palazzo", lat: "32.725953", lng: "-117.168563", liq: "Yes"});
        database.ref('Clairemont/The Stratton').set({lowestPrice:"1475", highestPrice: "2880", rating: "1.5", risk:"0.51-1.60 (High)", image:"Stratton.jpg", location:"Clairemont", estate2:"The Stratton", lat: "32.817387", lng: "-117.177610", liq: "No"});
        database.ref('Clairemont/Pacific Sands').set({lowestPrice:"1995", highestPrice: "2400", rating: "2.5", risk:"0.51-1.60 (High)", image:"PS.jpg", location:"Clairemont", estate2:"Pacific Sands", lat: "32.823028", lng: "-117.177570", liq: "No"});
        database.ref('Mission Valley/Aquatera').set({lowestPrice:"2290", highestPrice: "3495", rating: "4", risk:"0.51-1.60 (High)", image:"Aquatera.jpg", location:"Mission Valley", estate2:"Aquatera", lat: "32.778716", lng: "-117.153517", liq: "Yes"});
        database.ref('National City/Southern Highlands').set({lowestPrice:"995", highestPrice: "1195", rating: "1.5", risk:"0.18-0.50 (Low)", image:"SH.jpg", location:"National City", estate2:"Southern Highlands", lat: "32.663210", lng: "-117.092401", liq: "Yes"});
        database.ref('Otay/Southgate Village').set({lowestPrice:"1325", highestPrice: "1700", rating: "1", risk:"0.18-0.50 (Low)", image:"SG.jpg", location:"Otay", estate2:"Southgate Village", lat: "32.580853", lng: "-117.063458", liq: "Yes"});
      });


      // Resets Firebase to default mode (same function as resetButton but for different parts of body)
      $('#resetButton').click(()=> {
        console.log('resetting the database');
        database.ref('La Jolla/').remove();
        database.ref('Little Italy/').remove();
        database.ref('Clairemont/').remove();
        database.ref('La Jolla/Villas of Renaissance').set({lowestPrice:"1855", highestPrice: "3800", rating: "3.5", risk:"0.51-1.60 (High)", image:"VoR.jpg", location:"La Jolla", estate2: "Villas of Renaissance", lat: "32.869468", lng: "-117.203863", liq: "No"});
        database.ref('La Jolla/La Regencia').set({lowestPrice:"2000", highestPrice: "3600", rating: "2.5", risk:"0.51-1.60 (High)", image:"LR.jpg", location:"La Jolla", estate2: "La Regencia", lat: "32.863263", lng: "-117.223298", liq: "No"});
        database.ref('La Jolla/La Scala').set({lowestPrice:"1670", highestPrice: "1975", rating: "3", risk:"0.51-1.60 (High)", image:"LS.jpg", location:"La Jolla", estate2: "La Scala", lat: "32.867878", lng: "-117.223761", liq: "No"});
        database.ref('Little Italy/Camden Tuscany').set({lowestPrice:"2859", highestPrice: "3269", rating: "3.5", risk:"0.51-1.60 (High)",image:"Camden.jpg", location:"Little Italy", estate2:"Camden Tuscany", lat: "32.722293", lng: "-117.169368", liq: "Yes"});
        database.ref('Little Italy/Il Palazzo').set({lowestPrice:"1672", highestPrice: "3243", rating: "4", risk:"0.51-1.60 (High)",image:"IP.jpg",location:"Little Italy", estate2:"Il Palazzo", lat: "32.725953", lng: "-117.168563", liq: "Yes"});
        database.ref('Clairemont/The Stratton').set({lowestPrice:"1475", highestPrice: "2880", rating: "1.5", risk:"0.51-1.60 (High)", image:"Stratton.jpg", location:"Clairemont", estate2:"The Stratton", lat: "32.817387", lng: "-117.177610", liq: "No"});
        database.ref('Clairemont/Pacific Sands').set({lowestPrice:"1995", highestPrice: "2400", rating: "2.5", risk:"0.51-1.60 (High)", image:"PS.jpg", location:"Clairemont", estate2:"Pacific Sands", lat: "32.823028", lng: "-117.177570", liq: "No"});
        database.ref('Mission Valley/Aquatera').set({lowestPrice:"2290", highestPrice: "3495", rating: "4", risk:"0.51-1.60 (High)", image:"Aquatera.jpg", location:"Mission Valley", estate2:"Aquatera", lat: "32.778716", lng: "-117.153517", liq: "Yes"});
        database.ref('National City/Southern Highlands').set({lowestPrice:"995", highestPrice: "1195", rating: "1.5", risk:"0.18-0.50 (Low)", image:"SH.jpg", location:"National City", estate2:"Southern Highlands", lat: "32.663210", lng: "-117.092401", liq: "Yes"});
        database.ref('Otay/Southgate Village').set({lowestPrice:"1325", highestPrice: "1700", rating: "1", risk:"0.18-0.50 (Low)", image:"SG.jpg", location:"Otay", estate2:"Southgate Village", lat: "32.580853", lng: "-117.063458", liq: "Yes"});
      });


      // Takes in user inputted value to add a new listing to the database
      $('#insertButton').click(() => {
        const area = $('#insertAreaBox').val();
        const estate = $('#insertEstateBox').val();
        console.log('/' +area + '/'+ estate);
        database.ref('/' +area + '/'+ estate).set({
          lowestPrice: $('#insertLowestPriceBox').val(),
          highestPrice: $('#insertHighestPriceBox').val(),
          rating: $('#insertRatingBox').val(),
          risk: $('#insertRiskBox').val(),
          liq: $('#insertLiqBox').val(),
          image: $('#insertImageBox').val(),
          location : $('#insertAreaBox').val(),
          estate2 : $('#insertEstateBox').val(),
          lat: $('#insertLatBox').val(),
          lng:$('#insertLngBox').val(),
        });
        $('#status').html('You have added ' + estate + ' in ' + area);
      });

      // Searches up input user entered to delete a listing from the database
      $('#deleteButton').click(() => {
        const area = $('#deleteAreaBox').val();
        const estate = $('#deleteEstateBox').val();
        console.log('/' + area + '/' + estate);
        database.ref('/' + area + '/' + estate).remove();
        if (!estate) {
          $('#status1').html('You have cleared listings in ' + area);
        } else {
          $('#status1').html('You have deleted ' + estate + ' in ' + area);
        }
      });

    });
  </script>
</head>

<body>
  <header>
    <h2 onclick="location.href='housingApp.html'"> HousingTransparency </h2>
  </header>

  <nav>
    <ul class="top-menu" id="top-menu">
      <li><a onclick="location.href='mapNew.html'">MAP OF LISTINGS</a></li>
      <li><a id="resetButton">RESET DATA</a></li>
      <li><a onclick="location.href='housingApp.html'"> HOME PAGE </a></li>
    </ul>
  </nav>

  <div class="container">
    <img  height="80%" width="100%" src="header.png" alt="header" style="opacity:0.85">
    <h1>Add, Edit, Remove Listings</h1>
    <img class="banner__scroll-down" src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMjkgMTI5IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMjkgMTI5IiB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4Ij4KICA8Zz4KICAgIDxwYXRoIGQ9Im0xMjEuMywzNC42Yy0xLjYtMS42LTQuMi0xLjYtNS44LDBsLTUxLDUxLjEtNTEuMS01MS4xYy0xLjYtMS42LTQuMi0xLjYtNS44LDAtMS42LDEuNi0xLjYsNC4yIDAsNS44bDUzLjksNTMuOWMwLjgsMC44IDEuOCwxLjIgMi45LDEuMiAxLDAgMi4xLTAuNCAyLjktMS4ybDUzLjktNTMuOWMxLjctMS42IDEuNy00LjIgMC4xLTUuOHoiIGZpbGw9IiNGRkZGRkYiLz4KICA8L2c+Cjwvc3ZnPgo=" />

  </div>

  <div class='wrap'>

    <p>Add your own listing</p>
    <input id="insertAreaBox" type="text" size="20" placeholder="Area"/>
    <input id="insertEstateBox" type="text" size="20" placeholder="Estate"/>
    <input id="insertLowestPriceBox" type="text" size="20" placeholder="Lowest Price"/>
    <input id="insertHighestPriceBox" type="text" size="20" placeholder="Highest Price"/>
    <input id="insertRatingBox" type="text" size="20"/ placeholder="Rating">
    <input id="insertRiskBox" type="text" size="20"/ placeholder="Risk">
    <input id="insertLiqBox" type="text" size="20"/ placeholder="Liquefaction">
    <input id="insertImageBox" type="text" size="20"/ placeholder="Image">
    <input id="insertLatBox" type="number" size="20"/ placeholder="Latitude">
    <input id="insertLngBox" type="number" size="20"/ placeholder="Longitude">
    <button id="insertButton">Insert</button>
    <div id="status"></div>

    <p>Or delete an existing listing</p>
    <input id="deleteAreaBox" type="text" size="20" placeholder="Area"/>
    <input id="deleteEstateBox" type="text" size="20" placeholder="Estate"/>
    <button id="deleteButton">Delete</button>
    <div id="status1"></div>

    <p>Or reset the database to default</p>
    <button id="resetButton2">Reset</button>
    <div id="status2"></div>
  </body>
  </html>
