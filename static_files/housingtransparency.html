<html>
<head>
	>
	
<title>Housing Transparency</title>
<link href="/style.css" rel="stylesheet">

<script src="jquery-3.3.1.min.js"></script>

<script type="text/javascript">

$(document).ready(() => {
	console.log("hello world in the browser");
	$('#allLocationsButton').click(() => {
		$.ajax({
			url: 'users/',
			type: 'GET',
			dataType: 'json',
			success: (data) => {

				$('#status').html('Available locations in the area: ' + data);
			},
		});
	});

	$('#readButton').click(() => {
		const requestURL = 'users/' +$('#nameBox').val();
		const emptyUrl = $('#nameBox').val();
		console.log(requestURL);
		$.ajax({
			url: requestURL,
			type: 'GET',
			dataType: 'json',
			success: (data) => {
				const index = Object.keys(data); //data 的数字
				const length = Object.keys(data).length+1;
				//console.log("length" + length);
				if (emptyUrl == ""){
                  $('#title').html('Error: could not find user at URL: ' + requestURL);
					$('#residential').html("");

				}

				else if (length>0){
                    
					$('#title').html('Top housing options in your search area!');

                           $('#residential').html('');
				    	for (const e of index){
					$('#residential').append('<a href="#" onclick="showAdd()" id= "detailInfo">' + data[e] +  ' ' + '</a>' + '<br />');
					        //const estatesE = data[estates][e];
                             //console.log(data[e][1]);
				}

					$('#detailInfo').click((e) => {
                                  const txt = $(e.target).text();
                                  requestURL2 = requestURL + "/" + txt;
                                  console.log(requestURL2);

                                  $.ajax({
			                      url: requestURL2,
			                      type: 'GET',
			                      dataType: 'json',
			                      success: (data) => {
				                   $('#price').html('Available locations in the area: ' + data.price);
				                   console.log(data.price);
			                       },
		                           });

                            	});

				}

				else{

					$('#title').html('Error: could not find user at URL: ' + requestURL);
					$('#residential').html("");
				}
			    //$('#title').html('Top housing options in your search area!');
			    //$('#areaImage').attr('src', data.image);
				//$('#location').html( '1. ' + data.location);
				//$('#location2').html('2. ' + data.location2);
				/**$('#price').html('price is: ' + data.price);
				$('#crimeRate').html('Crime Rate is: ' + data.crimeRate);
				$('#earthquake').html('price is: ' + data.earthquake);
				$('#petImage').attr('src', data.pet);**/
			},
		});

	});



});






</script>

</head>
<body>
  <h1>Welcome to HousingTransparency!</h1>
  <p>Welcome to HousingTransparency, your one stop for obtaining all information regarding your housing. From earthquake risks, crime rates, convenience, to unit prices, HousingTransparency aims to make it easy for users to access all available data in a single click.</p>
  <p>Please click on "Get all available locations" to view all options</p>
  <button id="allLocationsButton">Get all available locations </button>
  <br>
  <br>
  Look up a location: <input id="nameBox" type="text" size="20"/>
  <button id="readButton">Get house</button>


  <div id="title"></div>
 <!--<a href = "housingInfo-VOR.html"><div id="location"></div></a>
 <a href = "housingInfo-LR.html"><div id="location2"></div></a>
 <a href = "Second-housingInfo-VORXXX.html"><div id="SecondLocation"></div></a>
  <a href = "Second-housingInfo-LRXXX.html"><div id="SecondLocation2"></div></a>
  <img id="areaImage"></img>-->
  <div id="residential">

  <div class = "information">
  <div id="price"></div>
    <div id="crimeRate"></div>
      <div id="earthquake"></div>

</div>
</div>

  <div id="status"></div>

  <script>

	function showAdd(){
	var introBar = document.getElementsByClassName("information")[0];
	introBar.style.display = 'block';
}

</script>

</body>
</html>
